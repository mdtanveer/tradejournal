{% extends "layout.html" %}

{% block content %}
<div class="container">
    <h5>
    <i class="bi-basket"></i>
    {{journalentrygroup.name}} 
    </h5>
    <h6>
        <span class="text-muted panel-text">
            <i>{{journalentrygroup.strategy.lower()}}</i>
        </span>
    </h6>
    <table class="table table-sm table-responsive-sm">
        <thead>
        <tr>
            <td>Instrument</td>
            <td>Entry</td>
            <td>Exit</td>
            <td>Entry Price</td>
            <td>Exit Price</td>
            <td>Quantity</td>
            <td>Gain</td>
            <td>Profit</td>
        </tr>
        </thead>
        <tbody>
        {% for journalentry in journalentrygroup.deserialized_items %}
        <tr>
            <td> <a href="/journalentry/{{journalentry.key}}/edit">{{journalentry.tradingsymbol}}</a></td>
            <td>{{journalentry.entry_time|formatdateonly}}</td>
            <td>{{journalentry.exit_time | formatdateonly if not zero_exit else ''}}</td>
            <td>{{journalentry.entry_price}}</td>
            <td>{{journalentry.exit_price}}</td>
            <td>{{journalentry.directionalqty()}}</td>
            <td>{{'%0.2f' % journalentry.points_gain() | float}}</td>
            <td>{{'%0.2f' % journalentry.profit() | float}}</td>
        </tr>
        {% endfor %}
        </tbody>
        <tfoot>
        <tr>
            <td>Total</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>{{'%0.2f' % journalentrygroup.points_gain() | float}}</td>
            <td>{{'%0.2f' % journalentrygroup.profit() | float}}</td>
        </tr>
        </tfoot>
    </table>

    <h4> Comments </h4>
    <br />
    {% if comments %}
    <table class="table table-hover">
        {% for comment in comments %}
        <tr>
            <th>
                {{ comment.add_time | formatdatetimedisplay }}
            </th>
            <td>
                {%if comment.title %}
                <b>
                    {{ comment.title }}
                </b><br />
                {% endif %}
                {{ comment.text }}
            </td>
        </tr>
        {% endfor %}
    </table>
    {{ pagination.links }}
    {% else %}
    <p>No comments available.</p>
    <br />
    {% endif %}
    <form action="" method="post" role="form" id="commentform">
        <div class="form-group">
            <div class="input text">
                <label for="title">Title:</label>
                <input id="commenttitlebox" class="form-control" name="title" type="text" value="">
            </div>
            <div class="input text">
                <label for="text">Text:</label>
                <textarea id="commentbox" class="form-control" name="text" required></textarea>
            </div>
        </div>
        <button type="submit" class="btn btn-success" id="postcommentbutton">Post Comment</button>
        <a class="btn btn-secondary btn-success" href="/journalentrygroup/{{journalentrygroup.key}}/edit">Edit</a>
    </form>
</div>
{% endblock %}
